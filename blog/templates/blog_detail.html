{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}{{ blog.title }}{% endblock %}
{% block blogs_list_active %}active{% endblock %}
{% block header_extends %}<link rel="stylesheet" href={% static 'blog.css' %}> {% endblock %}
{% block content %}
<div class="container">
    <div class="row">
        <div class="col-xs-10 col-xs-offset-1">
            <h3>{{ blog.title }}</h3>
            <ul class="blog-info">
                <li>作者: {{ blog.author }}</li>
                <li>分类: <a href={% url 'blogs_by_type' blog.blog_type.id %}>{{ blog.blog_type }}</a></li>
                <li>发表时间: {{ blog.created_time | date:"Y-m-d" }}&nbsp;&nbsp;&nbsp;&nbsp;阅读:{{ blog.get_read_num }}</li>
            </ul>
            <div class="blog-content">{{ blog.content | safe }}</div>
            <!-- {% autoescape off %}{{ blog.content }}{% endautoescape %} -->
            <div class="blog-more">
                {% if previous_blog %}
                    <p>上一篇:<a href="{% url 'blog_detail' previous_blog.id %}">{{ previous_blog.title }}</a></p>
                {% else %}
                    <p>上一篇:没有了!</p>
                {% endif %}
                {% if next_blog %}
                    <p>下一篇:<a href="{% url 'blog_detail' next_blog.id %}">{{ next_blog.title }}</a></p>
                {% else %}
                    <p>下一篇:没有了!</p>
                {% endif %}
            </div>
        </div>
    </div>
    <div>
        <!-- {{ request.COOKIES }} -->
        <div class="comment-area">
            <h3 class="comment-area-title">提交评论</h3>
            {% if request.session.session_key %}
                <form action="{% url 'update_comment' %}" method="POST" style="overflow:hidden;">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="comment-text">
                        {{ request.session.username }}~,欢迎评论！！</label>
                        <textarea id="comment-text" name="content" class="form-control" cols="15" rows="5"></textarea>
                    </div>
                    <input type="hidden" name="content_type" value="blog">
                    <input type="hidden" name="object_id" value="{{ blog.id }}">
                    <input type="submit" class="btn btn-primary" value="提交" style="float: right;"> 
                </form>
            {% else %}
                <h4>未登录,请登录后评论!</h4>
                <form action="{% url 'login' %}" class="form-inline" method="POST" style="margin-top: 2em">
                    {% csrf_token %}
                    <div class="form-group">
                        <lable class="sr-only" for="username"><h4>username</h4></lable>
                        <input id="username" type="text" class="form-control" name="username" placeholder="UserName">
                    </div>
                    <div class="form-group">
                        <lable class="sr-only" for="password"><h4>password</h4></lable>
                        <input id="password" type="password" class="form-control" name="password" placeholder="PassWord">
                    </div>
                    <input type="submit" class="btn btn-default" value="登录">
                </form>
            {% endif %}
        </div>
        <div class="comment-area">
            <h3 class="comment-area-title">评论列表</h3>
            {% for comment in comments %}
                {{ comment.create_time | date:'Y-m-d'}}&nbsp;{{ comment.user}}:{{ comment.content }}<br>
            {% empty %}
                暂时没有评论!
            {% endfor %}
        </div>
        
    </div>
    
</div>
    
{% endblock %}